<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.PasswordField?>
<?import javafx.scene.control.ProgressIndicator?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.RowConstraints?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>

<BorderPane xmlns="http://javafx.com/javafx/25" xmlns:fx="http://javafx.com/fxml/1" fx:controller="control.ControllerQuenMatKhau">

    <!-- Header -->
    <top>
        <HBox alignment="CENTER_LEFT" spacing="10" styleClass="app-header">
            <padding>
                <Insets bottom="16" left="24" right="24" top="16" />
            </padding>
         <Button fx:id="btnQuayLaiDangNhap" mnemonicParsing="false" onAction="#quayLaiDangNhap" text="Quay lại đăng nhập" />
        </HBox>
    </top>

    <!-- Content -->
    <center>
        <StackPane>
            <padding>
                <Insets bottom="24" left="24" right="24" top="24" />
            </padding>

            <VBox alignment="TOP_LEFT" maxWidth="520" spacing="18" styleClass="card">
                <padding>
                    <Insets bottom="24" left="24" right="24" top="24" />
                </padding>

                <!-- Mô tả -->
                <Label styleClass="muted" text="Nhập email để cấp lại mật khẩu mới. Vui lòng đổi mật khẩu ngay lập tức." wrapText="true" />

                <!-- Bước 1: Nhập email và gửi mã -->
                <GridPane hgap="12" vgap="10">
                    <columnConstraints>
                        <ColumnConstraints halignment="RIGHT" minWidth="120" />
                        <ColumnConstraints hgrow="ALWAYS" />
                    </columnConstraints>

                    <Label text="Email:" GridPane.columnIndex="0" GridPane.rowIndex="0" />
                    <TextField fx:id="txtEmail" promptText="vd: ten@example.com" GridPane.columnIndex="1" GridPane.rowIndex="0" />
                    <HBox spacing="8" GridPane.columnIndex="1" GridPane.rowIndex="1" />

                    <!-- Trạng thái bước 1 -->
                    <Label fx:id="lblTrangThaiOTP" styleClass="status" GridPane.columnIndex="1" GridPane.rowIndex="2" />
                     <Button fx:id="btnXacNhan" onAction="#datLaiMatKhau" text="Tiếp tục" GridPane.columnIndex="1" GridPane.rowIndex="2" />
               <rowConstraints>
                  <RowConstraints />
                  <RowConstraints />
                  <RowConstraints />
               </rowConstraints>
                </GridPane>

                <Separator />

                <!-- Bước 2: Đặt lại mật khẩu (ẩn/hiện bằng controller khi OTP hợp lệ) -->
                <GridPane fx:id="paneDatLai" hgap="12" managed="false" vgap="10" visible="false">
                    <columnConstraints>
                        <ColumnConstraints halignment="RIGHT" minWidth="120" />
                        <ColumnConstraints hgrow="ALWAYS" />
                    </columnConstraints>

                    <Label text="Mật khẩu mới:" GridPane.columnIndex="0" GridPane.rowIndex="0" />
                    <PasswordField fx:id="pfMatKhauMoi" promptText="Ít nhất 8 ký tự, gồm chữ &amp; số" GridPane.columnIndex="1" GridPane.rowIndex="0" />

                    <Label text="Xác nhận mật khẩu:" GridPane.columnIndex="0" GridPane.rowIndex="1" />
                    <PasswordField fx:id="pfXacNhan" promptText="Nhập lại mật khẩu mới" GridPane.columnIndex="1" GridPane.rowIndex="1" />

                    <Label fx:id="lblTrangThaiReset" styleClass="status" GridPane.columnIndex="1" GridPane.rowIndex="2" />

                    <HBox alignment="CENTER_RIGHT" spacing="10" GridPane.columnIndex="1" GridPane.rowIndex="3">
                        <Button fx:id="btnDatLai" defaultButton="true" onAction="#datLaiMatKhau" text="Đặt lại mật khẩu" />
                    </HBox>
               <rowConstraints>
                  <RowConstraints />
                  <RowConstraints />
                  <RowConstraints />
                  <RowConstraints />
               </rowConstraints>
                </GridPane>

                <!-- Footer nho nhỏ -->
                <Label styleClass="tiny-muted" text="Lưu ý: Vui lòng kiểm tra hộp thư Spam trước khi thử lại" wrapText="true" />
            </VBox>
        </StackPane>
    </center>

    <!-- Footer -->
    <bottom>
        <HBox alignment="CENTER_RIGHT" spacing="8" styleClass="app-footer">
            <padding>
                <Insets bottom="8" left="16" right="16" top="8" />
            </padding>
            <ProgressIndicator fx:id="progress" managed="false" prefHeight="18" prefWidth="18" visible="false" />
            <Label fx:id="lblThongBao" styleClass="status" />
        </HBox>
    </bottom>
</BorderPane>
